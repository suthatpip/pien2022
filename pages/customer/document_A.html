<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/png" href="/assets/img/logo.png">
    <title>AdminLTE 3 | Starter</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="/assets/plugins/fontawesome-free-6.1.1/css/all.min.css">
    <!-- daterange picker -->
    <link rel="stylesheet" href="/assets/plugins/daterangepicker/daterangepicker.css">
    <link rel="stylesheet" type="text/css" href="/assets/plugins/ckeditor5/css/styles.css">
    <link rel="stylesheet" href="/assets/plugins/bs-stepper/css/bs-stepper.min.css">
    <link  href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" rel="stylesheet" type="text/css" />
    <!-- Custom style -->
    <link rel="stylesheet" href="/assets/css/custom.css">

    <!-- Theme style -->
    <link rel="stylesheet" href="/assets/css/adminlte.min.css">

    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">

</head>

<body class="control-sidebar-slide-open layout-fixed layout-navbar-fixed">
    <div class="wrapper">
 
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="index3.html" class="nav-link">Home</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a href="#" class="nav-link">Contact</a>
                </li>
            </ul>

            <!-- Right navbar links -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link" data-toggle="dropdown" href="#">
                        <i class="far fa-bell"></i>
                        <span class="badge badge-danger navbar-badge">15</span>
                    </a>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-right">
                        <span class="dropdown-header">15 Notifications</span>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-envelope mr-2"></i> 4 new messages
                            <span class="float-right text-muted text-sm">3 mins</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-users mr-2"></i> 8 friend requests
                            <span class="float-right text-muted text-sm">12 hours</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item">
                            <i class="fas fa-file mr-2"></i> 3 new reports
                            <span class="float-right text-muted text-sm">2 days</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="#" class="dropdown-item dropdown-footer">See All Notifications</a>
                    </div>
                </li>
            </ul>
        </nav> 
        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            <a href="index3.html" class="brand-link">
                <img src="/assets/img/logo.png" alt="pien" class="brand-image " style="opacity: .8">
                <span class="brand-text font-weight-light">Admin Pien</span>
            </a>
            <div class="sidebar">
                <div class="user-panel mt-3 pb-3 mb-3 d-flex">
                    <div class="image">
                        <img src="/assets/img/user-default.jpg" class=" img-circle elevation-1">
                    </div>
                    <div class="info">
                        <a href="#" class="d-block">Alexander</a>
                    </div>
                </div>
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column text-sm" data-widget="treeview" role="menu"
                        data-accordion="false">
                        <li class="nav-item">
                            <a href="dashboard.html" class="nav-link  ">
                                <i class="nav-icon fas fa-solid fa-gauge-high"></i>
                                <p>แดชบอร์ด
                                </p>
                            </a>
                        </li>
                        <div >
                            <hr class="hr-sidebar">
                        </div>
                        <li class="nav-header text-white-50">ข้อมูลส่วนตัว
                        </li>
                        
                        <li class="nav-item ">
                            <a href="#" class="nav-link">
                                <i class="nav-icon fas fa-solid fa-circle-user"></i>
                                <p>
                                    จัดการข้อมูลส่วนตัว
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="account.html" class="nav-link  ">
                                        <i class="nav-icon far fa-circle text-info"></i>
                                        <p>บัญชีของฉัน
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <div >
                            <hr class="hr-sidebar">
                        </div>
                        <li class="nav-header text-white-50">จัดการประกาศ   
                        </li>
                        
                        <li class="nav-item ">
                            <a href="#" class="nav-link">
                                <i class="nav-icon fas fa-circle-arrow-up"></i>
                                <p>การอัพโหลด
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="upload.html" class="nav-link   ">
                                        <i class="nav-icon fas fa-solid fa-file-lines"></i>
                                        <p>อัพโหลดไฟล์
                                        </p>
                                    </a>
                                </li>
                            </ul>
                        </li> 
                        <li class="nav-item menu-open">
                            <a href="#" class="nav-link">
                                <i class="nav-icon fas fa-circle-arrow-up"></i>
                                <p>จัดการเอกสาร
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="/template/a" class="nav-link active">
                                        <i class="nav-icon fas fa-solid fa-file-lines"></i>
                                        <p>บริษัทสามัญ</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                  <a href="/template/b" class="nav-link   ">
                                      <i class="nav-icon fas fa-solid fa-file-lines"></i>
                                      <p>บริษัทวิสามัญ</p>
                                  </a>
                              </li>
                              <li class="nav-item">
                                <a href="/template/c" class="nav-link   ">
                                    <i class="nav-icon fas fa-solid fa-file-lines"></i>
                                    <p>ห้างหุ้นส่วนจำกัด</p>
                                </a>
                            </li>
                            </ul>
                        </li>
                         </ul>
                  </nav>
            </div>
        </aside> 
          <div class="content-wrapper">
            <section class="content-header">
              <div class="container-fluid">
                <div class="row mb-2">
                  <div class="col-sm-6">
                    <div class="badge bg-gradient-white text-left" style="width: 70%" > 
                      <h4  class="text-dark"><i class="fas fa-paint-brush"></i>
                        จัดการเอกสารสำหรับ บริษัทสามัญ
                      </h4>
                    </div> 
                  </div>
                  <div class="col-sm-6"> 
                    <div class="form-group">                     
                      <select custom-templates="template" class="form-control form-control-sm">
                        <option value="custom" selected disabled>เลือกเทมเพลต</option>
                        <option value="com-10" class="text-blue">หนังสือเชิญประชุมสามัญประจำปี (ปิดงบประจำปี)</option> 
                      </select>
                    </div> 
                  </div>
                </div>
              </div>
            </section>    
            <section class="content">
              <div class="container-fluid">               
                <div class="row">
                  <div class="col-md-12">
                    <div class="card card-default">
                      <div class="card-body p-0">
                        <div class="bs-stepper">
                          <div class="bs-stepper-header" role="tablist">
                            <div class="step" data-target="#newdocument-part">
                              <button type="button" class="step-trigger" role="tab" aria-controls="newdocument-part"
                                id="newdocument-part-trigger">
                                <span class="bs-stepper-circle">1</span>
                                <span class="bs-stepper-label">สร้างเอกสาร</span>
                              </button>
                            </div>
                            <div class="line"></div>
                            <div class="step" data-target="#booking-part">
                              <button type="button" class="step-trigger" role="tab" aria-controls="booking-part"
                                id="booking-part-trigger">
                                <span class="bs-stepper-circle">2</span>
                                <span class="bs-stepper-label">กำหนดวันที่ลงประกาศ</span>
                              </button>
                            </div>
                            <div class="line"></div>
                            <div class="step" data-target="#payment-part">
                              <button type="button" class="step-trigger" role="tab" aria-controls="payment-part"
                                id="payment-part-trigger">
                                <span class="bs-stepper-circle">2</span>
                                <span class="bs-stepper-label">ชำระเงิน</span>
                              </button>
                            </div>
                          </div>
                          <div class="bs-stepper-content">
                            <!-- <div class="form-group mb-3 centered"> -->
                              <div class="form-group mb-3 centered">
                                <label class="col-form-label" for="inputSuccess"><i class="fas fa-check"></i> กำหนดชื่อเอกสาร</label>
                                <input type="text" class="form-control " id="inputDocumentName" placeholder="Enter ...">                                
                              </div>                            
                            <div id="newdocument-part" class="content" role="tabpanel" aria-labelledby="newdocument-part-trigger">

                              <body data-editor="DecoupledDocumentEditor" data-collaboration="false"
                                data-revision-history="false">
                                <main>
                                  <div class="centered">
                                    <div class="row">
                                      <div class="document-editor__toolbar"></div>
                                    </div>
                                    <div class="row row-editor">
                                      <div class="editor-container">
                                        <div class="editor">                                               
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </main>
                                <footer>
                                
                                </footer>
                              </body>
                              <button class="btn btn-primary" onclick="stepper.next()">ถัดไป</button>
                            </div>
                            <div id="booking-part" class="content" role="tabpanel" aria-labelledby="booking-part-trigger">
                                <section class="content-header">
                                    <div class="container-fluid"> 
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="card card-default centered">                                           
                                                <div class="card-body">
                                                    <div id="actions" class="row">
                                                        <div class="col-lg-6 col-sm-6 ">                                                        
                                                            <span class="description"> <small class="text-muted">การลงประกาศจะมีผลตั้งแต่เวลา 00:00 ถึง 23:59 น.</small></span> 
                                                        </div>
                                                        <div class="col-lg-6  col-sm-6 d-flex align-items-center">
                                                            <input  class="form-control" data-publish-date="publish-date"  
                                                            readonly type="text" placeholder="DD/MM/YYYY - DD/MM/YYYY"  
                                                             style="width: 80%;" />  
                                                        </div>
                                                    </div>
                                            </div>                                      
                                        </div>
                                    </div>
                                    </div>
                                </section>

                                <button class="btn btn-primary" onclick="stepper.previous()">ก่อนหน้า</button>
                                <button class="btn btn-primary" onclick="summary();">ถัดไป</button>
                            </div>
                            <div id="payment-part" class="content" role="tabpanel" aria-labelledby="payment-part-trigger">                           
                                <section class="content-header">
                                    <div class="container-fluid">
                                      <div class="row">
                                        <div class="col-12">
                                           
                                          <!-- Main content -->
                                          <div class="invoice p-3 mb-3">
                                            <!-- title row -->
                                            <div class="row">
                                              <div class="col-12">
                                                <h4>
                                                  <!-- <i class="fas fa-globe"></i> AdminLTE, Inc. -->
                                                  <small class="float-right text-sm">วันที่: {{.date}}</small>
                                                </h4>
                                              </div>
                                              <!-- /.col -->
                                            </div>
                                            <!-- info row -->
                                            <div class="row invoice-info">
                                              
                                              <!-- /.col -->
                                              <div class="col-sm-6 invoice-col text-sm"> 
                                                <address>
                                                  <strong>{{.name}}</strong><br>
                                                  ที่อยู่: {{.address}}<br>
                                                  เบอร์โทรศัพท์: {{.telephone}}<br>
                                                  อีเมล์: {{.email}}
                                                </address>
                                              </div>
                                              <!-- /.col -->
                                              <div class="col-sm-6 invoice-col text-right pr-3"> 
                                                <br>
                                                <br>
                                                <b>หมายเลขออร์เดอร์:</b> {{.order}}<br>
                                                <b>กำหนดการชำระเงิน:</b> {{.paymentdue}}<br>
                                                <b>รหัส:</b> {{.account}}
                                              </div>
                                              
                                            </div>
                                            
                                            <!-- Table row -->
                                            <div class="row">
                                              <div class="col-12 table-responsive">
                                                <table class="table table-striped">
                                                  <thead>
                                                  <tr>
                                                    <th>ลำดับที่</th>
                                                    <th>ชนิดเอกสาร</th> 
                                                    <th>วันที่ประกาศ</th>
                                                    <th>ราคา</th>
                                                  </tr>
                                                  </thead>
                                                  <tbody>
                                                  
                                                   
                                                  <tr>
                                                    <td>1</td>
                                                    <td>Grown Ups Blue Ray</td> 
                                                    <td>Tousled lomo letterpress</td>
                                                    <td>$25.99</td>
                                                  </tr>


                                                  </tbody>
                                                </table>
                                              </div> 
                                            </div>
                                     
                              
                                            <div class="row"> 
                                              <div class="col-6" >  
                                                    <blockquote class="quote-light text-sm text-secondary" >
                                                      <dl>
                                                        <dt>รองรับการชำระเงินทั้งหมด 5 วิธี</dt>
                                                        <img src="/assets/img/credit/visa.png" alt="Visa">
                                                        <img src="/assets/img/credit/mastercard.png" alt="Mastercard">
                                                        <img src="/assets/img/credit/american-express.png" alt="American Express">
                                                        <dd> 
                                                          <ul>
                                                            <li>ชำระผ่านบัตรเครดิต/ บัตรเดบิต </li>
                                                            <li>ชำระผ่าน iBanking</li>
                                                            <li>ชำระผ่าน Mobile Banking</li>
                                                            <li>ชำระผ่าน ATM</li>
                                                            <li>ชำระโดยการโอนเงินและอัพโหลดสลิปหลักฐานการชำระเงิน</li> 
                                                          </ul> 
                                                        </dd>                                                      
                                                      </dl>
                                                    </blockquote> 
                                              </div>
                                              <!-- /.col -->
                                              <div class="col-6">
                                                <p class="lead">สรุปรายการ</p>
                              
                                                <div class="table-responsive">
                                                  <table class="table">
                                                    <tbody><tr>
                                                      <th style="width:70%">ยอดรวม:</th>
                                                      <td>250.30</td>
                                                      <td>บาท</td>
                                                    </tr>
                                                    <tr>
                                                      <th>ภาษีมูลค่าเพิ่ม </th>
                                                      <td>10.34</td>
                                                      <td>บาท</td>
                                                    </tr>
                                                    <tr>
                                                      <th>ส่วนลด:</th>
                                                      <td>5.80</td>
                                                      <td>บาท</td>
                                                    </tr>
                                                    <tr>
                                                      <th>รวมทั้งสิ้น:</th>
                                                      <td><strong>265.24</strong> </td>
                                                      <td>บาท</td>
                                                    </tr>
                                                  </tbody></table>
                                                </div>
                                              </div>
                                            </div>                              
                                            <!-- this row will not appear when printing -->
                                            <div class="row no-print">
                                              <div class="col-12">
                                              
                                                <button type="button" class="btn btn-success float-right"><i class="far fa-credit-card"></i>  
                                                  ชำระเงิน
                                                </button>
                                                
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                </section>
                              <button class="btn btn-primary" onclick="stepper.previous()">ก่อนหน้า</button>
                            </div>
                          </div>
                        </div>
                      </div>                     
                      <div class="card-footer">                       
                      </div>
                    </div>
                
                  </div>
                </div>
              </div>
            </section>
          </div> 
        <footer class="main-footer">
            Copyright &copy; PIEN CORPORATION CO., LTD
        </footer>
    </div>

    <script src="/assets/plugins/jquery/jquery.min.js"></script>
    <script src="/assets/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/plugins/chart.js/Chart.min.js"></script>    
    <script src="/assets/plugins/moment/moment-with-locales.js"></script>
    <script src="/assets/plugins/daterangepicker/daterangepicker.js"></script>
    <script src="/assets/plugins/dropzone/min/dropzone.min.js"></script>
    <script src="/assets/plugins/bs-stepper/js/bs-stepper.min.js"></script>

    <script src="/assets/plugins/ckeditor5/js/ckeditor.js"></script>
     <script src="/assets/js/adminlte.min.js"></script>
 
    <script>//inputDocumentName check  
      $('#inputDocumentName').on('keyup', function(e) { 
         if (isEmpty($('#inputDocumentName').val())){          
            $('#inputDocumentName').removeClass("is-invalid");
            $('#inputDocumentName').removeClass("is-valid");
         }else{         
            $('#inputDocumentName').removeClass("is-invalid");
            $('#inputDocumentName').addClass("is-valid");
         }  
      });
      function isEmpty(str) {
          return (!str || str.length === 0 );
      }
    </script>

    <script>
      var url=location.protocol + '//' + location.host;
      
      $('#template').change(function() {  
        fetch(url+'/template/'+$(this).val(), {
              method: 'POST',
              headers: {
                  'Content-Type': 'application/json',
              },          
          })
          .then(response => response.json())
          .then(data => {
              editor.setData(data.detail) 
          }).catch((error) => {
              console.error('Error:', error)
          })
      });
    </script>   
    <script>
        document.addEventListener('DOMContentLoaded', function () {
          window.stepper = new Stepper(document.querySelector('.bs-stepper'))
        })
    </script>
    <script>
        DecoupledDocumentEditor
          .create(document.querySelector('.editor'), { 
            licenseKey: '', 
          })
          .then(editor => {
            window.editor = editor;    
            document.querySelector('.document-editor__toolbar').appendChild(editor.ui.view.toolbar.element);
            document.querySelector('.ck-toolbar').classList.add('ck-reset_all');
          })
          .catch(error => {            
          });

    </script>
    <script>
        let publish = {
            start: "",
            end: "",
            get start() {
                return this._start;
            },
            get end() {
                return this._end;
            },
    
            set start(value) {
                // this.start= value;
                this._start = value;
            },
            set end(value) {
                // this.end= value;
                this._end = value;
            }
        };
        $( document ).ready(function() {  
            const systemFormatDate = "DD/MM/YYYY"  
            const formatDate = "DD/MM/YYYY" 
            const dateObj = new Date();
            const month = String(dateObj.getMonth() + 1).padStart(2, '0');
            const day = String(dateObj.getDate()).padStart(2, '0');
            const year = dateObj.getFullYear()+543;
            const today = String(day + '/' + month + '/' + year); 
            publish.start = moment( today , formatDate).format(systemFormatDate);
            publish.end =moment( today , formatDate).format(systemFormatDate); 
            moment.locale('th')  
            $('input[data-publish-date="publish-date"]').daterangepicker({ 
                "maxYear": 2023,
                "showCustomRangeLabel": false,
                "locale": {
                    "format": "DD MMM YYYY",
                    "separator": " - ",
                    "applyLabel": "Apply",
                    "cancelLabel": "Cancel",
                    "fromLabel": "From",
                    "toLabel": "To",
                    "customRangeLabel": "Custom",
                    "weekLabel": "W", 
                    "daysOfWeek": [
                        "อา",
                        "จ",
                        "อ",
                        "พ",
                        "พฤ",
                        "ศ",
                        "ส"
                    ],
                    "monthNames": [
                        "มกราคม ",
                        "กุมภาพันธ์ ",
                        "มีนาคม ",
                        "เมษายน",
                        "พฤษภาคม",
                        "มิถุนายน",
                        "กรกฎาคม",
                        "สิงหาคม",
                        "กันยายน",
                        "ตุลาคม",
                        "พฤศจิกายน",
                        "ธันวาคม"
                    ],
                    "firstDay": 1
                },
                "startDate": moment( today , formatDate).format('LL') ,
                "endDate":moment( today , formatDate).format('LL'),
                "minDate": today
            });
    
            $('input[data-publish-date="publish-date"]').on('apply.daterangepicker', function(ev, picker) {
                publish.start = picker.startDate.format(systemFormatDate);
                publish.end =picker.endDate.format(systemFormatDate); 
              });
               
              $('input[data-publish-date="publish-date"]').on('hide.daterangepicker', function(ev, picker) { 
                publish.start = picker.startDate.format(systemFormatDate);
                publish.end =picker.endDate.format(systemFormatDate); 
              });

        });
    </script>
    <script>
      function summary(){
        var file_name = $('#inputDocumentName').val();
        if (isEmpty(file_name)){
            $('#inputDocumentName').removeClass("is-valid");
            $('#inputDocumentName').addClass("is-invalid");
            return
        }else{
          var url=location.protocol + '//' + location.host;  
         
          fetch(url+'/verify', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                  start_date: publish.start, 
                  end_date:  publish.end,
                  file_name: file_name
                })          
          })
          .then(response => response.json())
          .then(data => {
              editor.setData(data.detail) 
          }).catch((error) => {
              console.error('Error:', error)
          })



            stepper.next()
        }
      //   const template= $('select[custom-templates="template"]')
      //   if (template.val()==null){
      //     console.log("custom")
      //   }else{
      //     console.log( template.val());
      //   }
      //   console.log("publish.start " + publish.start);
      //  console.log("publish.end " + publish.end);
      // 
      // fetch(url+'/template/'+$(this).val(), {
      //       method: 'POST',
      //       headers: {
      //           'Content-Type': 'application/json',
      //       },          
      //   })
      //   .then(response => response.json())
      //   .then(data => {
      //       editor.setData(data.detail) 
      //   }).catch((error) => {
      //       console.error('Error:', error)
      //   })
    
      }
    </script>
</body>

</html>